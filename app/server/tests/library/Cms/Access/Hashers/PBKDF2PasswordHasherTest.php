<?php

namespace library\Cms\Access\Hashers;


use Cms\Access\Hashers\PBKDF2PasswordHasher;

/**
 * Class PBKDF2PasswordHasherTest
 *
 * @package library\Cms\Access\Hashers
 */
class PBKDF2PasswordHasherTest extends \PHPUnit_Framework_TestCase
{

  public function test_createPassword()
  {
    $ph = new PBKDF2PasswordHasher();
    $pwHash = $ph->create('some$Password', 'FAKE_SALT');
    $this->assertEquals($pwHash, 'pbkdf2_sha256$12000$FAKE_SALT$LvqmzCKxnAucV65/doJ0Ds8enSr4C97n');
  }

  public function test_passwordShouldBeValid()
  {
    $ph = new PBKDF2PasswordHasher();
    // generated by django
    $this->assertTrue($ph->validate('123', 'pbkdf2_sha256$12000$COkz0I0VMpdd$WaetCgn3IiuXXIqN50pbB9c571Tef53kW04bPCso7Xg='));
    // generated by php
    $this->assertTrue($ph->validate('aij!ai}V1thu@ushiith', 'pbkdf2_sha256$12000$W6SRCws0iTPV3OIJJD5Z/zDx1i7jiZbb$8TT4uz5LWkOb7QlVuIdYPksPQ0jAmntr'));
  }

}
