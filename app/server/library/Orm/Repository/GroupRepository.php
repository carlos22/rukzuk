<?php

namespace Orm\Repository;

use Doctrine\ORM\EntityRepository;

/**
 * GroupRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class GroupRepository extends EntityRepository
{
  /**
   * @param  string $websiteId
   *
   * @return array
   */
  public function findByWebsiteIdAndOrderByName($websiteId)
  {
    $dql = 'SELECT DISTINCT g FROM Orm\\Entity\\Group g'
      . ' WHERE g.websiteid = :websiteid ORDER BY LOWER(g.name)';

    $query = $this->_em->createQuery($dql);
    $query->setParameter('websiteid', $websiteId);
    return $query->getResult();
  }

  /**
   * @param string $userId
   *
   * @return array
   */
  public function findByUserId($userId)
  {
    $dql = 'SELECT DISTINCT g FROM Orm\\Entity\\GROUP g'
      . ' WHERE g.users LIKE :usersid';

    $query = $this->_em->createQuery($dql);
    $query->setParameter('usersid', '%'.$userId.'%');
    return $query->getResult();
  }
  /**
   * @param string   $userId
   * @param string   $websiteId
   *
   * @return array[] Orm\Entity\Group
   */
  public function findByUserAndWebsiteId($userId, $websiteId)
  {
    $dql = 'SELECT DISTINCT g FROM Orm\\Entity\\GROUP g'
      . ' WHERE g.users LIKE :usersid'
      . ' AND g.websiteid = :websiteid';

    $query = $this->_em->createQuery($dql);
    $query->setParameter('websiteid', $websiteId);
    $query->setParameter('usersid', '%'.$userId.'%');
    return $query->getResult();
  }
}
