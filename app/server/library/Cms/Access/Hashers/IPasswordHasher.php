<?php
namespace Cms\Access\Hashers;

/**
 * Interface PasswordHasher
 *
 * @package Cms\Access
 */
interface IPasswordHasher
{

  /**
   * Creates a hash for the given password
   *
   * @param string      $password the password to hash
   *
   * @param string|null $salt     salt, if not provided this should be randomly generated by the impl
   *
   * @return string             the hashed password in format <algorithm>$<iterations>$<salt>$<hash>
   */
  public function create($password, $salt = null);

  /**
   * Checks if the given password matches the given hash
   *
   * @param string $password  the password to check
   * @param string $good_hash the hash which should be match the password
   *
   * @return boolean             true if $password and $good_hash match, false otherwise
   */
  public function validate($password, $good_hash);


  /**
   * Tells weather the password (hash) is usable (checks prefix, format etc.)
   * @param $password
   *
   * @return mixed
   */
  public function isPasswordUsable($password);
}
